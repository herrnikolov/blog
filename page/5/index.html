<!DOCTYPE html>
<html lang="en-US"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Stefcho's Tech Blog - Page 5 of 7 - Software Development, Cloud, DevOps and PfSense</title><meta name="description" content="Software Development, Cloud, DevOps and PfSense"><meta property="og:locale" content="en_US"><meta property="og:type" content="website"><meta property="og:title" content="Stefcho's Tech Blog - Page 5 of 7 - Software Development, Cloud, DevOps and PfSense"><meta property="og:description" content="Software Development, Cloud, DevOps and PfSense"><meta property="og:url" content="https://blog.stefcho.eu/"><meta property="og:site_name" content="Stefcho's Tech Blog"><meta name="msvalidate.01" content="820A9AB94DD773C49A23A3B5ABC83853"><script type="application/ld+json" class="yoast-schema-graph yoast-schema-graph--main">{
    "@context": "https://schema.org",
    "@graph": [
        {
            "@type": "Organization",
            "@id": "https://blog.stefcho.eu/#organization",
            "name": "",
            "url": "https://blog.stefcho.eu/",
            "sameAs": []
        },
        {
            "@type": "WebSite",
            "@id": "https://blog.stefcho.eu/#website",
            "url": "https://blog.stefcho.eu/",
            "name": "Stefcho's Tech Blog",
            "publisher": {
                "@id": "https://blog.stefcho.eu/#organization"
            },
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://blog.stefcho.eu/?s={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        },
        {
            "@type": "WebPage",
            "@id": "https://blog.stefcho.eu/page/5/#webpage",
            "url": "https://blog.stefcho.eu/page/5/",
            "inLanguage": "en-US",
            "name": "Stefcho's Tech Blog - Page 5 of 7 - Software Development, Cloud, DevOps and PfSense",
            "isPartOf": {
                "@id": "https://blog.stefcho.eu/#website"
            },
            "about": {
                "@id": "https://blog.stefcho.eu/#organization"
            },
            "description": "Software Development, Cloud, DevOps and PfSense"
        }
    ]
}</script><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//s.w.org"><script type="text/javascript" data-cfasync="false">
	var mi_version         = '7.6.0';
	var mi_track_user      = true;
	var mi_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-11255880-2';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
	
	if ( mi_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

		__gaTracker('create', 'UA-11255880-2', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('require', 'displayfeatures');
		__gaTracker('send','pageview');
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + mi_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
					})();
		}
</script><link rel="stylesheet" id="wp-block-library-css" href="https://blog.stefcho.eu/wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all"><link rel="stylesheet" id="micro-style-css" href="https://blog.stefcho.eu/wp-content/themes/micro/assets/css/master.css" type="text/css" media="all"><link rel="stylesheet" id="primary-font-css" href="https://fonts.googleapis.com/css?family=Roboto+Mono%3A400%2C500&subset=latin%2Ccyrillic%2Cgreek%2Cvietnamese&ver=5.2" type="text/css" media="all"><link rel="stylesheet" id="wpgdprc.css-css" href="https://blog.stefcho.eu/wp-content/plugins/wp-gdpr-compliance/assets/css/front.css" type="text/css" media="all"><style id="wpgdprc.css-inline-css" type="text/css">

            div.wpgdprc .wpgdprc-switch .wpgdprc-switch-inner:before { content: 'Yes'; }
            div.wpgdprc .wpgdprc-switch .wpgdprc-switch-inner:after { content: 'No'; }
        
</style><script type="text/javascript">
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,exe,js,pdf,ppt,tgz,zip,xls","inbound_paths":"[]","home_url":"https:\/\/PLACEHOLDER.wpsho","hash_tracking":"false"};
/* ]]> */
</script><script type="text/javascript" src="https://blog.stefcho.eu/wp-content/plugins/google-analytics-for-wordpress/assets/js/frontend.min.js"></script><script type="text/javascript" src="https://blog.stefcho.eu/wp-includes/js/jquery/jquery.js"></script><script type="text/javascript" src="https://blog.stefcho.eu/wp-includes/js/jquery/jquery-migrate.min.js"></script><style data-context="foundation-flickity-css">/*! Flickity v2.0.2
http://flickity.metafizzy.co
---------------------------------------------- */.flickity-enabled{position:relative}.flickity-enabled:focus{outline:0}.flickity-viewport{overflow:hidden;position:relative;height:100%}.flickity-slider{position:absolute;width:100%;height:100%}.flickity-enabled.is-draggable{-webkit-tap-highlight-color:transparent;tap-highlight-color:transparent;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.flickity-enabled.is-draggable .flickity-viewport{cursor:move;cursor:-webkit-grab;cursor:grab}.flickity-enabled.is-draggable .flickity-viewport.is-pointer-down{cursor:-webkit-grabbing;cursor:grabbing}.flickity-prev-next-button{position:absolute;top:50%;width:44px;height:44px;border:none;border-radius:50%;background:#fff;background:hsla(0,0%,100%,.75);cursor:pointer;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.flickity-prev-next-button:hover{background:#fff}.flickity-prev-next-button:focus{outline:0;box-shadow:0 0 0 5px #09f}.flickity-prev-next-button:active{opacity:.6}.flickity-prev-next-button.previous{left:10px}.flickity-prev-next-button.next{right:10px}.flickity-rtl .flickity-prev-next-button.previous{left:auto;right:10px}.flickity-rtl .flickity-prev-next-button.next{right:auto;left:10px}.flickity-prev-next-button:disabled{opacity:.3;cursor:auto}.flickity-prev-next-button svg{position:absolute;left:20%;top:20%;width:60%;height:60%}.flickity-prev-next-button .arrow{fill:#333}.flickity-page-dots{position:absolute;width:100%;bottom:-25px;padding:0;margin:0;list-style:none;text-align:center;line-height:1}.flickity-rtl .flickity-page-dots{direction:rtl}.flickity-page-dots .dot{display:inline-block;width:10px;height:10px;margin:0 8px;background:#333;border-radius:50%;opacity:.25;cursor:pointer}.flickity-page-dots .dot.is-selected{opacity:1}</style><style data-context="foundation-slideout-css">.slideout-menu{position:fixed;left:0;top:0;bottom:0;right:auto;z-index:0;width:256px;overflow-y:auto;-webkit-overflow-scrolling:touch;display:none}.slideout-menu.pushit-right{left:auto;right:0}.slideout-panel{position:relative;z-index:1;will-change:transform}.slideout-open,.slideout-open .slideout-panel,.slideout-open body{overflow:hidden}.slideout-open .slideout-menu{display:block}.pushit{display:none}</style><style type="text/css">
		/* Normal background color and text */
		body, code, kbd, tt, var, pre, input, textarea, select {
			color:#00aa13;
			background-color:#060c08;
		}

		/* Inverted background color and text */
		a:hover,
		.entry .entry-title,
		.comment-form-comment label,
		.form-submit input[type="submit"],
		.widget_calendar caption,
		.comments-area .comments-title,
		.main-navigation.is-extended .sub-menu a:hover,
		.menu-toggle {
			color:#060c08;
			background-color:#00aa13;
		}

		/* Overwrite for links */
		a,
		.main-navigation .menu-item a,
		.main-navigation .sub-menu a:hover,
		button, input  {
			color:#00aa13;
		}

		/* Borders */
		input, button, textarea, select
		.site-footer,
		.homepage-welcome {
			border-color:#00aa13;
		}

		.entry .entry-title a,
		.entry .entry-title a:hover {
			color: #060c08;
		}
	</style><link rel="icon" href="https://blog.stefcho.eu/wp-content/uploads/2018/10/cropped-0-32x32.jpg" sizes="32x32"><link rel="icon" href="https://blog.stefcho.eu/wp-content/uploads/2018/10/cropped-0-192x192.jpg" sizes="192x192"><link rel="apple-touch-icon-precomposed" href="https://blog.stefcho.eu/wp-content/uploads/2018/10/cropped-0-180x180.jpg"><meta name="msapplication-TileImage" content="https://blog.stefcho.eu/wp-content/uploads/2018/10/cropped-0-270x270.jpg"><style>.ios7.web-app-mode.has-fixed header{ background-color: rgba(3,122,221,.88);}</style><style type="text/css" id="wp-custom-css">
			  .entry .entry-content {
    margin: 50px 0; }		</style></head><body class="home blog paged paged-5 hfeed">
<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header"><div class="header-image">
			<a href="https://blog.stefcho.eu/" rel="home">
				<img src="/wp-content/uploads/2018/10/0.jpg" height="350" width="1400" alt=""></a>
		</div>
		
		<div class="row">
			<div class="columns small-12">
				<div class="site-branding">
											<h1 class="site-title"><a href="https://blog.stefcho.eu/" rel="home">Stefcho's Tech Blog</a></h1>
											<p class="site-description">Software Development, Cloud, DevOps and PfSense</p>
									</div>

				<nav id="site-navigation" class="main-navigation"><button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
						<span class="screen-reader-text">Menu</span>
					</button>
					<div class="menu-primary-container">
						<div id="primary-menu" class="menu"></div>
					</div>
				</nav></div>
		</div>
	</header><div id="content" class="site-content">

	<section class="section-fullwidth section-main"><div class="row">
			<div class="columns small-12 medium-8">
				<div id="primary" class="content-area">
					<main id="main" class="site-main"><article id="post-576" class="entry post-576 post type-post status-publish format-standard hentry category-technical tag-network tag-openvpn tag-pfsense tag-site-to-site"><header class="entry-header"><h2 class="entry-title"><a href="https://blog.stefcho.eu/building-site-to-site-connection-with-openvpn-on-pfsense-2-0-rc1-with-shared-key/" rel="bookmark">Building Site to Site Connection with OpenVPN on pfSense 2.0 RC1 with Shared Key</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <time class="entry-date published" datetime="2011-05-02T02:28:11+02:00">02/05/2011</time> - <time class="updated" datetime="2019-02-18T14:48:26+02:00">18/02/2019</time></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://blog.stefcho.eu/author/darko/">Stefan</a></span></span>		</div>
			</header><div class="entry-content">
		<p> </p>
<p>Sooner or later you will have two or more geographically distant LAN that you want to connect together. Whether we are speaking about to branch offices or home and office, or simply your office LAN and some co located servers in a data center, it is only a matter of time before you need such solution.</p>
<p>In this case we will use two pfSense 2.0 RC1, one in each remote location.</p>
<p>The map shows our lab setup for the purpose.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/OpenVPN-Site-to-Site-on-pfSense-2.0.png"><img class="aligncenter size-full wp-image-577" title="OpenVPN Site to Site on pfSense 2.0" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/OpenVPN-Site-to-Site-on-pfSense-2.0.png" alt="" width="746" height="139" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/OpenVPN-Site-to-Site-on-pfSense-2.0.png 746w,https://blog.stefcho.eu/wp-content/uploads/2011/05/OpenVPN-Site-to-Site-on-pfSense-2.0-300x55.png 300w" sizes="(max-width: 746px) 100vw, 746px"></a></p>
<p>In this post we will use Shared Key as a way to authenticate the two routers.</p>
<p>On pfSense01, this machine will play the role of server in this scenario.</p>
<p>Go to VPN > OpenVPN, on the Server leaf, add new one<a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-01-OpenVPN-Conifuration.png"><img class="aligncenter size-full wp-image-578" title="Configure pfsense01 as a Server - 01 - OpenVPN Conifuration" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-01-OpenVPN-Conifuration.png" alt="" width="1024" height="369" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-01-OpenVPN-Conifuration.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-01-OpenVPN-Conifuration-300x108.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>As Server Mode choose <strong>Peer to Peer (Shared key)</strong></p>
<p>Protocol, Device Mode, Interface, Local port – you can leaf the default for now.</p>
<p>Description – Enter whatever is informative for you.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-02-OpenVPN-Conifuration.png"><img class="aligncenter size-full wp-image-579" title="Configure pfsense01 as a Server - 02 - OpenVPN Conifuration" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-02-OpenVPN-Conifuration.png" alt="" width="1024" height="741" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-02-OpenVPN-Conifuration.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-02-OpenVPN-Conifuration-300x217.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a>Encryption algorithm, choose one by your preference, keep in mind that different algorithms have different load on the server. I use BF-CBC (128-bit)</p>
<p> </p>
<p>Choose different from both of your LAN subnets for Tunnel Network, in our case 10.0.8.0/24.</p>
<p>Local Network – The LAN behind the pfSense01, in this example 10.10.9.0/24.</p>
<p>Remote Network – this is the LAN behind the pfSense02, as on the diagram 10.10.10.0/24.</p>
<p>Click on Save button and we are Done.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-03-OpenVPN-Conifuration.png"><img class="aligncenter size-full wp-image-580" title="Configure pfsense01 as a Server - 03 - OpenVPN Conifuration" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-03-OpenVPN-Conifuration.png" alt="" width="1024" height="740" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-03-OpenVPN-Conifuration.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-03-OpenVPN-Conifuration-300x216.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Open the newly configured server and copy the Shared Key. We will need it for the setup of pfSense02.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-04-OpenVPN-Conifuration.png"><img class="aligncenter size-full wp-image-581" title="Configure pfsense01 as a Server - 04 - OpenVPN Conifuration" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-04-OpenVPN-Conifuration.png" alt="" width="1024" height="741" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-04-OpenVPN-Conifuration.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-04-OpenVPN-Conifuration-300x217.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Go to Firewall > Rules, on the WAN leaf, add new rule</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-05-Network-Rules.png"><img class="aligncenter size-full wp-image-582" title="Configure pfsense01 as a Server - 05 - Network Rules" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-05-Network-Rules.png" alt="" width="1024" height="221" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-05-Network-Rules.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-05-Network-Rules-300x64.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-05.5-Network-Rules.png"><img class="aligncenter size-full wp-image-584" title="Configure pfsense01 as a Server - 05.5 - Network Rules" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-05.5-Network-Rules.png" alt="" width="1024" height="367" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-05.5-Network-Rules.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-05.5-Network-Rules-300x107.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a>The Action is Pass, Select WAN as Interface, UDP as Protocol.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-06-Network-Rules-WAN.png"><img class="aligncenter size-full wp-image-583" title="Configure pfsense01 as a Server - 06 - Network Rules - WAN" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-06-Network-Rules-WAN.png" alt="" width="1024" height="741" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-06-Network-Rules-WAN.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-06-Network-Rules-WAN-300x217.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>For Destination port range, select OpenVPN in our case it is 1194, if you have used some other port in the configuration enter it here. Enter some description also. <a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-07-Network-Rules.png"><img class="aligncenter size-full wp-image-585" title="Configure pfsense01 as a Server - 07 - Network Rules" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-07-Network-Rules.png" alt="" width="1024" height="739" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-07-Network-Rules.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-07-Network-Rules-300x216.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Go to the OpenVPN leaf. Here I have made a very basic Allow All rule. If you have some security concerns, or want to limit the communication between the two sites, make one or more rules to fit your need.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-08-Network-Rules-OpenVPN.png"><img class="aligncenter size-full wp-image-586" title="Configure pfsense01 as a Server - 08 - Network Rules OpenVPN" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-08-Network-Rules-OpenVPN.png" alt="" width="1024" height="740" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-08-Network-Rules-OpenVPN.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-08-Network-Rules-OpenVPN-300x216.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-09-Network-Rules-OpenVPN.png"><img class="aligncenter size-full wp-image-587" title="Configure pfsense01 as a Server - 09 - Network Rules OpenVPN" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-09-Network-Rules-OpenVPN.png" alt="" width="1024" height="741" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-09-Network-Rules-OpenVPN.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-09-Network-Rules-OpenVPN-300x217.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p> </p>
<p>pfSense02 will play the role of client.</p>
<p>Go to VPN > OpenVPN, on the Client leaf, add new one</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense01-as-a-Server-09-Network-Rules-OpenVPN1.png"></a><a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-01-OpenVPN-confiugration.png"></a><a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-01-OpenVPN-confiugration1.png"><img class="aligncenter size-full wp-image-590" title="Configure pfsense02 as a Client - 01 - OpenVPN confiugration" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-01-OpenVPN-confiugration1.png" alt="" width="1024" height="379" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-01-OpenVPN-confiugration1.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-01-OpenVPN-confiugration1-300x111.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>As Server Mode choose <strong>Peer to Peer (Shared key)</strong></p>
<p>Protocol, match the one from the server in our case UDP, Device mode – tun, Interface is WAN, Local port, leave empty for random, or enter manually one if you want.</p>
<p>Server host or address, enter the WAN IP address on the first router pfSense01, in our case 10.10.2.2. Server port, whatever port you have used on the server, in our case the default 1194.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-02-OpenVPN-confiugration.png"><img class="aligncenter size-full wp-image-591" title="Configure pfsense02 as a Client - 02 - OpenVPN confiugration" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-02-OpenVPN-confiugration.png" alt="" width="1024" height="741" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-02-OpenVPN-confiugration.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-02-OpenVPN-confiugration-300x217.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Enter Description. For Shared Key, paste the one from the pfSense01 here. Encryption algorithm, duplicate the one from the first configuration, in our case BF-CBC (128-bit).</p>
<p>Tunnel Network, duplicate the one from the server. Remote Network is the LAN network behind the pfSense01, for our example 10.10.9.0/24.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-03-OpenVPN-confiugration.png"><img class="aligncenter size-full wp-image-592" title="Configure pfsense02 as a Client - 03 - OpenVPN confiugration" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-03-OpenVPN-confiugration.png" alt="" width="1024" height="740" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-03-OpenVPN-confiugration.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-03-OpenVPN-confiugration-300x216.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Leave the rest to default, and Save the configuration.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-04-OpenVPN-confiugration.png"><img class="aligncenter size-full wp-image-593" title="Configure pfsense02 as a Client - 04 - OpenVPN confiugration" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-04-OpenVPN-confiugration.png" alt="" width="1024" height="739" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-04-OpenVPN-confiugration.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-04-OpenVPN-confiugration-300x216.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Again add a rule on the OpenVPN leaf in the Firewall > Rules section to allow traffic flow between the two sites. Here again I’ve setup a rule that Allow All traffic between the two sites.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-05-OpenVPN-Rule.png"><img class="aligncenter size-full wp-image-596" title="Configure pfsense02 as a Client - 05 - OpenVPN Rule" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-05-OpenVPN-Rule.png" alt="" width="1024" height="456" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-05-OpenVPN-Rule.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-05-OpenVPN-Rule-300x133.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Now go to Status > OpenVPN. You should see that Status equals UP.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-05-OpenVPN-Status.png"><img class="aligncenter size-full wp-image-594" title="Configure pfsense02 as a Client - 05 - OpenVPN Status" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-05-OpenVPN-Status.png" alt="" width="1024" height="418" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-05-OpenVPN-Status.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-05-OpenVPN-Status-300x122.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-06-OpenVPN-Status.png"><img class="aligncenter size-full wp-image-595" title="Configure pfsense02 as a Client - 06 - OpenVPN Status" src="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-06-OpenVPN-Status.png" alt="" width="1024" height="254" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-06-OpenVPN-Status.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/05/Configure-pfsense02-as-a-Client-06-OpenVPN-Status-300x74.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a>Now you should be able to successfully communicate with hosts from the other network.</p>
	</div>

	<footer class="entry-footer"><span class="cat-links">Posted in <a href="https://blog.stefcho.eu/category/technical/" rel="category tag">Technical</a></span><span class="tags-links">Tagged <a href="https://blog.stefcho.eu/tag/network/" rel="tag">Network</a>, <a href="https://blog.stefcho.eu/tag/openvpn/" rel="tag">OpenVPN</a>, <a href="https://blog.stefcho.eu/tag/pfsense/" rel="tag">pfSense</a>, <a href="https://blog.stefcho.eu/tag/site-to-site/" rel="tag">Site To Site</a></span><span class="comments-link"><a href="https://blog.stefcho.eu/building-site-to-site-connection-with-openvpn-on-pfsense-2-0-rc1-with-shared-key/#comments">11 Comments</a></span>	</footer></article><article id="post-545" class="entry post-545 post type-post status-publish format-standard hentry category-technical tag-adds tag-openvpn tag-pfsense tag-radius tag-windows-server-2008-r2"><header class="entry-header"><h2 class="entry-title"><a href="https://blog.stefcho.eu/openvpn-with-radius-authentication-on-pfsense-2-0-rc1/" rel="bookmark">OpenVPN with RADIUS authentication on pfSense 2.0 RC1</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <time class="entry-date published" datetime="2011-04-26T16:32:32+02:00">26/04/2011</time> - <time class="updated" datetime="2019-02-18T14:47:34+02:00">18/02/2019</time></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://blog.stefcho.eu/author/darko/">Stefan</a></span></span>		</div>
			</header><div class="entry-content">
		<p>This is the last post in the series of authentication alternatives for OpenVPN in pfSense 2.0 RC1.</p>
<p>In the previous posts we looked at the <a href="http://stefcho.azurewebsites.net/?p=492" target="_blank">local database</a> of pfSense and <a href="http://stefcho.azurewebsites.net/?p=528" target="_blank">Active Directory</a>. Now we will use Remote Authentication Dial In User Service (RADIUS) instead. Again we will authenticate our users against Active Directory, as domain user accounts.</p>
<p>For that purpose we need to add <strong>Network Policy and Access Services</strong> server role to our Windows Server 2008 R2.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/ADDS-Add-NPS-roles-02.png"><img class="aligncenter size-full wp-image-546" title="ADDS Add NPS roles 02" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/ADDS-Add-NPS-roles-02.png" alt="" width="801" height="576" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/ADDS-Add-NPS-roles-02.png 801w,https://blog.stefcho.eu/wp-content/uploads/2011/04/ADDS-Add-NPS-roles-02-300x215.png 300w" sizes="(max-width: 801px) 100vw, 801px"></a></p>
<p>From the Role services select only the<strong> Network Policy Server</strong>. We don’t need any of the other services.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/ADDS-Add-NPS-roles-03.png"><img class="aligncenter size-full wp-image-547" title="ADDS Add NPS roles 03" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/ADDS-Add-NPS-roles-03.png" alt="" width="801" height="577" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/ADDS-Add-NPS-roles-03.png 801w,https://blog.stefcho.eu/wp-content/uploads/2011/04/ADDS-Add-NPS-roles-03-300x216.png 300w" sizes="(max-width: 801px) 100vw, 801px"></a></p>
<p>After the successful installation, open the Network Policy Server console. Under RADIUS Clients and Servers, create new RADIUS Client.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-add-new-RADIUS-Client-01.png"><img class="aligncenter size-full wp-image-548" title="NPS add new RADIUS Client 01" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-add-new-RADIUS-Client-01.png" alt="" width="1024" height="244" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-add-new-RADIUS-Client-01.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-add-new-RADIUS-Client-01-300x71.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a>Take note of the Friendly name of the client, we will use is later in the Network Policy. In our case pfSense.</p>
<p>Enter the LAN address of pfSense, and Shared secret.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-add-new-RADIUS-Client-02-Details.png"><img class="aligncenter size-full wp-image-549" title="NPS add new RADIUS Client 02 Details" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-add-new-RADIUS-Client-02-Details.png" alt="" width="746" height="654" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-add-new-RADIUS-Client-02-Details.png 746w,https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-add-new-RADIUS-Client-02-Details-300x263.png 300w" sizes="(max-width: 746px) 100vw, 746px"></a></p>
<p>Leave the default configuration on the Advanced leaf.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-add-new-RADIUS-Client-03-Details.png"><img class="aligncenter size-full wp-image-550" title="NPS add new RADIUS Client 03 Details" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-add-new-RADIUS-Client-03-Details.png" alt="" width="745" height="656" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-add-new-RADIUS-Client-03-Details.png 745w,https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-add-new-RADIUS-Client-03-Details-300x264.png 300w" sizes="(max-width: 745px) 100vw, 745px"></a></p>
<p>We won’t configure additional Connection request Polies.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-Connection-Request-Poliocies.png"><img class="aligncenter size-full wp-image-551" title="NPS Connection Request Poliocies" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-Connection-Request-Poliocies.png" alt="" width="1024" height="768" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-Connection-Request-Poliocies.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-Connection-Request-Poliocies-300x225.png 300w,https://blog.stefcho.eu/wp-content/uploads/2011/04/NPS-Connection-Request-Poliocies-200x150.png 200w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>A new Network Policy is needed, because the default<strong> Connections to other access servers</strong> block requests send by pfSense.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-01.png"><img class="aligncenter size-full wp-image-552" title="Network Policies New 01" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-01.png" alt="" width="1024" height="768" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-01.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-01-300x225.png 300w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-01-200x150.png 200w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Enter Policy name of your preference, and leave the default Type of network access server to Unspecified. Otherwise your authentication request will be denied.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-02.png"><img class="aligncenter size-full wp-image-553" title="Network Policies New 02" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-02.png" alt="" width="687" height="588" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-02.png 687w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-02-300x256.png 300w" sizes="(max-width: 687px) 100vw, 687px"></a>For Condition, let’s add the Client Friendly Name. In our case the client is our pfSense router. Type in here the Friendly name that you used in the RADIUS Client configuration. In our case pfSense.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-04.png"></a><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-05.png"><img class="aligncenter size-full wp-image-555" title="Network Policies New 05" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-05.png" alt="" width="686" height="589" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-05.png 686w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-05-300x257.png 300w" sizes="(max-width: 686px) 100vw, 686px"></a><br>
On Specify Access Permission, leave Access granted.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-06.png"><img class="aligncenter size-full wp-image-556" title="Network Policies New 06" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-06.png" alt="" width="689" height="586" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-06.png 689w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-06-300x255.png 300w" sizes="(max-width: 689px) 100vw, 689px"></a></p>
<p>As Authentication Methods add Unencrypted authentication (PAP, SPAP). The explanation follows later.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-07.png"><img class="aligncenter size-full wp-image-557" title="Network Policies New 07" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-07.png" alt="" width="688" height="586" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-07.png 688w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-07-300x255.png 300w" sizes="(max-width: 688px) 100vw, 688px"></a>Leave constraints to defaults, if you don’t have some specific requirements. The same is valid for Settings too.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-08.png"><img class="aligncenter size-full wp-image-558" title="Network Policies New 08" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-08.png" alt="" width="687" height="585" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-08.png 687w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-08-300x255.png 300w" sizes="(max-width: 687px) 100vw, 687px"></a><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-09.png"><img class="aligncenter size-full wp-image-559" title="Network Policies New 09" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-09.png" alt="" width="687" height="588" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-09.png 687w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-09-300x256.png 300w" sizes="(max-width: 687px) 100vw, 687px"></a></p>
<p>All done</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-10.png"><img class="aligncenter size-full wp-image-560" title="Network Policies New 10" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-10.png" alt="" width="690" height="588" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-10.png 690w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-10-300x255.png 300w" sizes="(max-width: 690px) 100vw, 690px"></a><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-11.png"><img class="aligncenter size-full wp-image-561" title="Network Policies New 11" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-11.png" alt="" width="1024" height="768" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-11.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-11-300x225.png 300w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Network-Policies-New-11-200x150.png 200w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>On your pfSense go to System > User Management > Servers add new.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-Configure-RADIUS-Authentication-01.png"><img class="aligncenter size-full wp-image-562" title="pfSense Configure RADIUS Authentication 01" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-Configure-RADIUS-Authentication-01.png" alt="" width="1024" height="680" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-Configure-RADIUS-Authentication-01.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-Configure-RADIUS-Authentication-01-300x199.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Enter descriptive name of your liking. As type select Radius. Enter the IP address of the server that we just configure to be our RADIUS server. Under Services offered, leave the default Authentication and Accounting. Take note that we have not configured accounting on our NPS service, but you could easily enable it. The default ports are fine. If you have Windows Firewall, or some other kind of firewall service running, make sure required ports are open.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-Configure-RADIUS-Authentication-02.png"><img class="aligncenter size-full wp-image-563" title="pfSense Configure RADIUS Authentication 02" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-Configure-RADIUS-Authentication-02.png" alt="" width="1024" height="702" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-Configure-RADIUS-Authentication-02.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-Configure-RADIUS-Authentication-02-300x205.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>It is time to go to your OpenVPN Server configuration and select our new RADIUS provider as <strong>Backend for authentication</strong>.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-OpenVPN-Server-Authentication-configuration.png"><img class="aligncenter size-full wp-image-564" title="pfSense OpenVPN Server Authentication configuration" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-OpenVPN-Server-Authentication-configuration.png" alt="" width="1024" height="549" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-OpenVPN-Server-Authentication-configuration.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-OpenVPN-Server-Authentication-configuration-300x160.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Now if you make test connection with test user, take a look at the security logs on the RADIUS server.</p>
<p>You will see RADIUS Client Friendly Name match out configuration, and which Policies were used,<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Verify-Successful-connection-in-the-Security-Logs-02.png"><img class="aligncenter size-full wp-image-565" title="Verify Successful connection in  the  Security Logs 02" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/Verify-Successful-connection-in-the-Security-Logs-02.png" alt="" width="1024" height="768" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/Verify-Successful-connection-in-the-Security-Logs-02.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Verify-Successful-connection-in-the-Security-Logs-02-300x225.png 300w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Verify-Successful-connection-in-the-Security-Logs-02-200x150.png 200w" sizes="(max-width: 1024px) 100vw, 1024px"></a>and that the Authentication Type is PAP, that is why we added it to the policy earlier.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Verify-Successful-connection-in-the-Security-Logs-04.png"><img class="aligncenter size-full wp-image-566" title="Verify Successful connection in  the  Security Logs 04" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/Verify-Successful-connection-in-the-Security-Logs-04.png" alt="" width="1024" height="768" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/Verify-Successful-connection-in-the-Security-Logs-04.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Verify-Successful-connection-in-the-Security-Logs-04-300x225.png 300w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Verify-Successful-connection-in-the-Security-Logs-04-200x150.png 200w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>That’s it.</p>
	</div>

	<footer class="entry-footer"><span class="cat-links">Posted in <a href="https://blog.stefcho.eu/category/technical/" rel="category tag">Technical</a></span><span class="tags-links">Tagged <a href="https://blog.stefcho.eu/tag/adds/" rel="tag">ADDS</a>, <a href="https://blog.stefcho.eu/tag/openvpn/" rel="tag">OpenVPN</a>, <a href="https://blog.stefcho.eu/tag/pfsense/" rel="tag">pfSense</a>, <a href="https://blog.stefcho.eu/tag/radius/" rel="tag">RADIUS</a>, <a href="https://blog.stefcho.eu/tag/windows-server-2008-r2/" rel="tag">Windows Server 2008 R2</a></span><span class="comments-link"><a href="https://blog.stefcho.eu/openvpn-with-radius-authentication-on-pfsense-2-0-rc1/#comments">5 Comments</a></span>	</footer></article><article id="post-528" class="entry post-528 post type-post status-publish format-standard hentry category-technical tag-adds tag-ldap tag-openvpn tag-pfsense tag-windows-server-2008-r2"><header class="entry-header"><h2 class="entry-title"><a href="https://blog.stefcho.eu/openvpn-with-ldap-authentication-on-pfsense-2-0-rc1/" rel="bookmark">OpenVPN with LDAP authentication on pfSense 2.0 RC1</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <time class="entry-date published" datetime="2011-04-22T13:20:56+02:00">22/04/2011</time> - <time class="updated" datetime="2019-02-18T14:47:10+02:00">18/02/2019</time></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://blog.stefcho.eu/author/darko/">Stefan</a></span></span>		</div>
			</header><div class="entry-content">
		<p>In the last post I’ve used Local User Database for authentication with the OpenVPN Server, but managing users in multiple places is redundant and should be avoided. If your users resides in Windows Domain why not use a Domain Controller for authenticating VPN users.</p>
<p>That’s way now we will use Active Directory.</p>
<p>For the purpose I’ve setup a Windows Server with Active Directory Domain Services. In a new Organization Unit called Test Users, there are a service account (domain\vpnsvc), and user account with witch we’ll do the tests (domain\user2).</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/ADDS-OU-with-Users.png"><img class="aligncenter size-full wp-image-529" title="ADDS OU with Users" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/ADDS-OU-with-Users.png" alt="" width="554" height="245" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/ADDS-OU-with-Users.png 554w,https://blog.stefcho.eu/wp-content/uploads/2011/04/ADDS-OU-with-Users-300x132.png 300w" sizes="(max-width: 554px) 100vw, 554px"></a></p>
<p>On the pfSense go to System > User Manager > Servers</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers.png"><img class="aligncenter size-full wp-image-530" title="pfSense 2.0 System Authentication Servers" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers.png" alt="" width="1024" height="339" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers-300x99.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a><br>
Add new one with the + sign button.</p>
<p>For Type select LDAP<br>
Enter the IP address of your Domain Controller</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers-Configure-LDAP.png"><img class="aligncenter size-full wp-image-531" title="pfSense 2.0 System Authentication Servers - Configure LDAP" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers-Configure-LDAP.png" alt="" width="1024" height="768" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers-Configure-LDAP.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers-Configure-LDAP-300x225.png 300w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers-Configure-LDAP-200x150.png 200w" sizes="(max-width: 1024px) 100vw, 1024px"></a><br>
In the Search scope, you have to enter the Base DN, you can find it by using ADSI Edit.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/ADSI-Edit-Domain.png"><img class="aligncenter size-full wp-image-532" title="ADSI Edit Domain" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/ADSI-Edit-Domain.png" alt="" width="1024" height="204" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/ADSI-Edit-Domain.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/ADSI-Edit-Domain-300x59.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a><br>
Now for Authentication containers, click on Select button and choose the ones in which users that will have access through VPN are.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers-Configure-LDAP-Select-Authentication-Containers.png"><img class="aligncenter size-full wp-image-533" title="pfSense 2.0 System Authentication Servers - Configure LDAP - Select Authentication Containers" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers-Configure-LDAP-Select-Authentication-Containers.png" alt="" width="1024" height="768" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers-Configure-LDAP-Select-Authentication-Containers.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers-Configure-LDAP-Select-Authentication-Containers-300x225.png 300w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers-Configure-LDAP-Select-Authentication-Containers-200x150.png 200w" sizes="(max-width: 1024px) 100vw, 1024px"></a><br>
Remove the tick from <strong>Use anonymous binds to resolve distinguished names</strong>, and enter the credentials for your service account. In my case this is the domain\vpnsvc service account.<br>
For initial Template select Microsoft AD</p>
<p><a href="../wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers-Configure-LDAP.png"><img title="pfSense 2.0 System Authentication Servers - Configure LDAP" src="../wp-content/uploads/2011/04/pfSense-2.0-System-Authentication-Servers-Configure-LDAP.png" alt="" width="1024" height="768"></a></p>
<p>Now on the Wizard for creating new OpenVPN Server<br>
As Type of Server select LDAP<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-OpenVPN-Wizard-Select-Authentication-backedn-Type-LDAP.png"><img class="aligncenter size-full wp-image-534" title="pfSense 2.0 OpenVPN Wizard Select Authentication backedn Type - LDAP" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-OpenVPN-Wizard-Select-Authentication-backedn-Type-LDAP.png" alt="" width="1024" height="435" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-OpenVPN-Wizard-Select-Authentication-backedn-Type-LDAP.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-OpenVPN-Wizard-Select-Authentication-backedn-Type-LDAP-300x127.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>As a LDAP server, select the connection that we have configured just now.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-OpenVPN-Wizard-Select-LDAP-Authentication-Server.png"><img class="aligncenter size-full wp-image-535" title="pfSense 2.0 OpenVPN Wizard Select LDAP Authentication Server" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-OpenVPN-Wizard-Select-LDAP-Authentication-Server.png" alt="" width="1024" height="481" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-OpenVPN-Wizard-Select-LDAP-Authentication-Server.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-OpenVPN-Wizard-Select-LDAP-Authentication-Server-300x140.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Continue with the configuration of the OpenVPN server as usual, for references you can check my previous blog post on the topic <a href="http://stefcho.azurewebsites.net/?p=492" target="_blank">pfSense 2.0 RC1 configuration of OpenVPN Server for Road Warrior with TLS and User Authentication</a><strong> </strong><strong> </strong></p>
<p>Now you can connect to the VPN using domain users account, in my example domain\user2.</p>
<p>I’ve test is and now if you disable some user account in Active Directory, you will not authenticate with the AD, and consequently connect to the OpenVPN.</p>
<p>To extend the configuration you can use multiple backend service to authenticate. Open you OpenVPN server configuration and in the section <strong>Backend for authentication</strong> select also the Local Database, or any other available to you. There is a little flow in this method. If you have a user with the same user name and the same password, the request is send first to the AD and after that the local database is queried for the user. I’ve guessed it after a little network sniffing. However how often would you have duplicate users in both databases at the same time? So this is just for your information.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-OpenVPN-Server-Multiple-Backedn-for-Authentication.png"><img class="aligncenter size-full wp-image-536" title="pfSense 2.0 OpenVPN Server Multiple Backedn for Authentication" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-OpenVPN-Server-Multiple-Backedn-for-Authentication.png" alt="" width="1024" height="539" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-OpenVPN-Server-Multiple-Backedn-for-Authentication.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-2.0-OpenVPN-Server-Multiple-Backedn-for-Authentication-300x157.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Thank you for reading, have fun.</p>
	</div>

	<footer class="entry-footer"><span class="cat-links">Posted in <a href="https://blog.stefcho.eu/category/technical/" rel="category tag">Technical</a></span><span class="tags-links">Tagged <a href="https://blog.stefcho.eu/tag/adds/" rel="tag">ADDS</a>, <a href="https://blog.stefcho.eu/tag/ldap/" rel="tag">LDAP</a>, <a href="https://blog.stefcho.eu/tag/openvpn/" rel="tag">OpenVPN</a>, <a href="https://blog.stefcho.eu/tag/pfsense/" rel="tag">pfSense</a>, <a href="https://blog.stefcho.eu/tag/windows-server-2008-r2/" rel="tag">Windows Server 2008 R2</a></span><span class="comments-link"><a href="https://blog.stefcho.eu/openvpn-with-ldap-authentication-on-pfsense-2-0-rc1/#comments">17 Comments</a></span>	</footer></article><article id="post-492" class="entry post-492 post type-post status-publish format-standard hentry category-technical tag-openvpn tag-pfsense"><header class="entry-header"><h2 class="entry-title"><a href="https://blog.stefcho.eu/pfsense-2-0-rc1-configuration-of-openvpn-server-for-rad-warrior-with-tls-and-user-authentication/" rel="bookmark">pfSense 2.0 RC1 configuration of OpenVPN Server for Road Warrior with TLS and User Authentication</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <time class="entry-date published" datetime="2011-04-17T17:06:26+02:00">17/04/2011</time> - <time class="updated" datetime="2019-02-18T15:58:17+02:00">18/02/2019</time></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://blog.stefcho.eu/author/darko/">Stefan</a></span></span>		</div>
			</header><div class="entry-content">
		<p>VPN is very important service nowadays. The possibility to connect to remote network is very powerful feature used by single user accessing files at home to thousands of business users working remotely with applications and services available previously only on their desktops in the office.  Because of that there are many alternative on the market providing such service. In this post I will focus on the OpenVPN running on the new version of pfSense 2.0 RC1. The goal is to compare the new features with the capabilities of the older 1.2.3 version.</p>
<p>One of the reasons choosing OpenVPN was for the rich feature set, small system requirements the level of control. You can easily setup is up on virtual machine or on SoHo router. The possibility to authenticate users not by insecure usernames and passwords, but by certificates was very compelling.</p>
<p>On 1.2.3 version of pfSense, instead of generating the certificates on the router, I was generating them on a Windows Machine. Following guidance from this sources:</p>
<p><a href="http://www.runpcrun.com/howtoopenvpn" target="_blank">http://www.runpcrun.com/howtoopenvpn</a></p>
<p><a href="http://openvpn.net/index.php/open-source/documentation/howto.html#pki" target="_blank">http://openvpn.net/index.php/open-source/documentation/howto.html#pki</a></p>
<p>After generating all the required certificates, it was just a matter of copy / paste in the configuration.</p>
<p>In the new 2.0 version of pfSense there is a Cert Manager. Using it you  can manage your certificate on the box, not just pasting pre-generated  certificates.</p>
<p>The other new feature that we will use is User Manager. You have three options for central location of your users: local database, LDAP and RADIUS.For this post we will use local database, as it is the easiest way.</p>
<p> </p>
<p>As a first  step, let’s install the “OpenVPN Client Export Utility” package, from System > Packages. We will need it later.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPn-Client-Export-Utility2.png"><img class="aligncenter size-full wp-image-501" title="OpenVPn Client Export Utility" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPn-Client-Export-Utility2.png" alt="" width="1024" height="456" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPn-Client-Export-Utility2.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPn-Client-Export-Utility2-300x133.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Then go to System > Cert Management. On the CA (Certificate Authority) leaf, create new one. Take a note of the <strong>Descriptive </strong>and <strong>Common </strong>names you give it, we will need them later. Enter the rest of the details for the CA.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Create-CA-Cert.png"></a><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Create-CA-Cert1.png"><img class="aligncenter size-full wp-image-502" title="Create CA Cert" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/Create-CA-Cert1.png" alt="" width="1024" height="739" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/Create-CA-Cert1.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Create-CA-Cert1-300x216.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Now under System > User Management, create new user account.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Create-New-User.png"><img class="aligncenter size-full wp-image-503" title="Create New User" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/Create-New-User1.png" alt="" width="1024" height="741" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/Create-New-User1.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Create-New-User1-300x217.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a>Tick in the Certificate section “Click to create a user certificate.”, or after the user is created, enter the newly created user account and generate a certificate for the user. As a Method select “Create an Internal Certificate”, enter the Distinguished name details.</p>
<p>Now is time to configure the OpneVPN server. Go under VPN > OpenVPN, select the <strong>Wizard </strong>leaf.</p>
<p>For type of Server, select Local User Access<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-011.png"><img class="aligncenter size-full wp-image-504" title="OpenVPN Wizz 01" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-011.png" alt="" width="1024" height="438" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-011.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-011-300x128.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>For Certificate Authority Select the name of the one we created earlier, in our case Road Warrior CA<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-02.png"><img class="aligncenter size-full wp-image-505" title="OpenVPN Wizz 02" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-02.png" alt="" width="1024" height="481" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-02.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-02-300x140.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>For Server Certificate, select Add New Certificate, type in something  memorable for Descriptive name, because we will use it right away.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-03.png"><img class="aligncenter size-full wp-image-506" title="OpenVPN Wizz 03" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-03.png" alt="" width="1024" height="480" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-03.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-03-300x140.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p> </p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Server-Certificate-Creation.png"><img class="aligncenter size-full wp-image-507" title="OpenVPN Server Certificate Creation" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Server-Certificate-Creation.png" alt="" width="1024" height="740" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Server-Certificate-Creation.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Server-Certificate-Creation-300x216.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Now edit the configuration of the OpenVPN server. On this page you can enable TLS.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-04-Confgiuration.png"><img class="aligncenter size-full wp-image-508" title="OpenVPN Wizz 04- Confgiuration" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-04-Confgiuration.png" alt="" width="1024" height="742" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-04-Confgiuration.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-04-Confgiuration-300x217.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Select the size of DH, Encryption Algorithm.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-05-Configuration-II.png"><img class="aligncenter size-full wp-image-509" title="OpenVPN Wizz 05 - Configuration II" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-05-Configuration-II.png" alt="" width="1024" height="741" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-05-Configuration-II.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-05-Configuration-II-300x217.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a>for Tunnel Network choose a subnet that different from your LAN subnet. In the Local Network enter your LAN subnet. Decide on the number of Concurrent Connections, and if you want to use compression.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-06-Configuration-III.png"><img class="aligncenter size-full wp-image-510" title="OpenVPN Wizz 06 - Configuration III" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-06-Configuration-III.png" alt="" width="1024" height="739" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-06-Configuration-III.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-06-Configuration-III-300x216.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-07-Configuration-III.png"></a></p>
<p>As this is a very basic configuration, we won’t enter DNS servers, and Default Domain, but you should consider these options, depending on your environment.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-07-Configuration-III.png"><img class="aligncenter size-full wp-image-511" title="OpenVPN Wizz 07 - Configuration III" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-07-Configuration-III.png" alt="" width="1024" height="740" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-07-Configuration-III.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/OpenVPN-Wizz-07-Configuration-III-300x216.png 300w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Now go to VPN > OpenVPN, select the <strong>Client Export</strong> leaf. The package that we have installed in the beginning gives us the possibility to automatically export archive with the user configuration files.</p>
<p>Find the user for whom you want to export configuration, and click on the<strong> Configuration archive</strong> link.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/Export-User-Configuration.png"><img class="aligncenter size-full wp-image-513" title="Export User Configuration" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/Export-User-Configuration.png" alt="" width="1024" height="768" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/Export-User-Configuration.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Export-User-Configuration-300x225.png 300w,https://blog.stefcho.eu/wp-content/uploads/2011/04/Export-User-Configuration-200x150.png 200w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>If you haven’t already download the OpenVPN client, download and install OpenVPN Client with GUI from <a href="http://swupdate.openvpn.net/community/releases/openvpn-2.1.4-install.exe" target="_blank">Here</a><a href="http://swupdate.openvpn.net/community/releases/openvpn-2.1.4-install.exe"></a></p>
<p>Now open the Configuration Archive and extract the files in this location on the machine from which you are going to establish the VPN connection.</p>
<blockquote><p>C:\Program Files\OpenVPN\config\</p></blockquote>
<p> </p>
<p>You should be able to successfully connect to your VPN from outside.<br>
The management of users and certificate is much easier in pfSense 2.0. You don’t have to keep a Certificate Authority on separate box, and the discomfort with transferring the CRLs is gone. The utility that generates bundles with the required certificates and configuration for each user automate most of the tedious manual work from the previous version.</p>
<p>As a bonus I have recorded the process of configuration, you can check it out here:</p>
<p> </p>
	</div>

	<footer class="entry-footer"><span class="cat-links">Posted in <a href="https://blog.stefcho.eu/category/technical/" rel="category tag">Technical</a></span><span class="tags-links">Tagged <a href="https://blog.stefcho.eu/tag/openvpn/" rel="tag">OpenVPN</a>, <a href="https://blog.stefcho.eu/tag/pfsense/" rel="tag">pfSense</a></span><span class="comments-link"><a href="https://blog.stefcho.eu/pfsense-2-0-rc1-configuration-of-openvpn-server-for-rad-warrior-with-tls-and-user-authentication/#comments">28 Comments</a></span>	</footer></article><article id="post-455" class="entry post-455 post type-post status-publish format-standard hentry category-technical tag-dd-wrt tag-pfsense"><header class="entry-header"><h2 class="entry-title"><a href="https://blog.stefcho.eu/1-1-nat-in-pfsense-and-dd-wrt/" rel="bookmark">1 : 1 NAT in pfSense and DD-WRT</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <time class="entry-date published" datetime="2011-04-08T21:18:23+02:00">08/04/2011</time> - <time class="updated" datetime="2019-02-18T14:45:51+02:00">18/02/2019</time></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://blog.stefcho.eu/author/darko/">Stefan</a></span></span>		</div>
			</header><div class="entry-content">
		<p>Sometimes you need to map internal machine IP to real IP address accessible from the Internet.<a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/1-to-1-NAT-Diagram.png"><img class="aligncenter size-full wp-image-456" title="1 to 1 NAT Diagram" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/1-to-1-NAT-Diagram.png" alt="" width="439" height="217" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/1-to-1-NAT-Diagram.png 439w,https://blog.stefcho.eu/wp-content/uploads/2011/04/1-to-1-NAT-Diagram-300x148.png 300w" sizes="(max-width: 439px) 100vw, 439px"></a>As on the diagram if someone makes a request to 1.1.1.2, the request is send to 192.168.1.10.</p>
<p>On DD-WRT you can use DMZ. This service is pseudo-DMZ, more commonly known outside of the SoHo routes as Exposed host.</p>
<p>To set is up enter the NAT / QoS section, then select the DMZ subsection, and configure your internal IP. For more information read <a href="http://de.wikipedia.org/wiki/Demilitarized_Zone" target="_blank">here</a></p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/DD-WRT-DMZ.png"><img class="aligncenter size-large wp-image-457" title="DD-WRT---DMZ" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/DD-WRT-DMZ-1024x367.png" alt="" width="586" height="210" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/DD-WRT-DMZ-1024x367.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/04/DD-WRT-DMZ-300x107.png 300w,https://blog.stefcho.eu/wp-content/uploads/2011/04/DD-WRT-DMZ.png 1028w" sizes="(max-width: 586px) 100vw, 586px"></a></p>
<p>Be warned that exposing all port of a machine to the Internet is very insecure, and even worse if the machine does not have some kind of firewall.</p>
<p>In pfSense, the alternative is to use VIP and 1:1 NAT</p>
<p>You can’t do that in 1.2.3, if you have only one WAN IP, if you do an error message appears: “The WAN IP address may not be used in a 1:1 rule”. Alternative is to make a port forward, which is much more preferable especially if not all ports are included.</p>
<p>So first you must add your additional WAN IP in the Virtual IP section.</p>
<p>For Type you can choose between Proxy ARP and CARP, detailed explanation why check out <a href="http://doc.pfsense.org/index.php/What_are_Virtual_IP_Addresses%3F" target="_blank">here</a></p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-VIP-1.2.3.png"><img class="aligncenter size-full wp-image-458" title="pfSense-VIP-1.2.3" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-VIP-1.2.3.png" alt="" width="807" height="582" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-VIP-1.2.3.png 807w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-VIP-1.2.3-300x216.png 300w" sizes="(max-width: 807px) 100vw, 807px"></a></p>
<p>Then create a 1 : 1 NAT rule</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-NAT-1-to-1-1.2.3.png"><img class="aligncenter size-full wp-image-461" title="pfSense-NAT-1-to-1-1.2.3" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-NAT-1-to-1-1.2.3.png" alt="" width="811" height="318" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-NAT-1-to-1-1.2.3.png 811w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-NAT-1-to-1-1.2.3-300x117.png 300w" sizes="(max-width: 811px) 100vw, 811px"></a>Nothing special in the configuration, just enter your internal and external IPs and description for the rule.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-NAT-1-to-1-Details-1.2.3.png"><img class="aligncenter size-full wp-image-462" title="pfSense-NAT-1-to-1-Details-1.2.3" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-NAT-1-to-1-Details-1.2.3.png" alt="" width="810" height="413" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-NAT-1-to-1-Details-1.2.3.png 810w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-NAT-1-to-1-Details-1.2.3-300x152.png 300w" sizes="(max-width: 810px) 100vw, 810px"></a></p>
<p>You must make a firewall rule for all this to work, enter the internal LAN IP address as destination.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-Firewall-Rule-1.2.3.png"><img class="aligncenter size-full wp-image-470" title="pfSense-Firewall-Rule-1.2.3" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-Firewall-Rule-1.2.3.png" alt="" width="816" height="664" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-Firewall-Rule-1.2.3.png 816w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-Firewall-Rule-1.2.3-300x244.png 300w" sizes="(max-width: 816px) 100vw, 816px"></a></p>
<p>On pfSense 2.0 RC1, except the huge amount of new options the only difference is the new option in the Virtual IP type selection. The IP Alias works fine in this setup. The other good news is that even if you have only one WAN IP address you can use is in such setup. The bad news is that you do use it you can’t use your WAN IP for anything else, all port on the WAN IP are mapped to the machine on the LAN.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-VIP-2.0.png"><img class="aligncenter size-full wp-image-482" title="pfSense-VIP-2.0" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-VIP-2.0.png" alt="" width="1012" height="604" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-VIP-2.0.png 1012w,https://blog.stefcho.eu/wp-content/uploads/2011/04/pfSense-VIP-2.0-300x179.png 300w" sizes="(max-width: 1012px) 100vw, 1012px"></a></p>
<p>Alright so far this was the case if you have need to publish only one IP, but if you need to do this for multiple machine and have more than one WAN IP address, the procedure is a little different.</p>
<p>On pfSense you just repeat the procedure as many times as you need.</p>
<p>On DD-WRT you can add some iptables rules.</p>
<p>Add these lines to the Startup script:</p>
<blockquote><p>WANIF=`get_wanface`</p>
<p>ifconfig $WANIF:1 10.10.1.10 netmask 255.255.255.0 broadcast 10.10.1.255</p></blockquote>
<p>This adds the new WAN Ip to the Interface</p>
<p>Add these lines to the Firewall script:</p>
<blockquote><p>iptables -t nat -I PREROUTING -d 10.10.1.10 -j DNAT –to-destination 10.10.9.9</p>
<p>iptables -t nat -I POSTROUTING -s 10.10.9.9 -j -p all SNAT –to-source 10.10.1.10</p>
<p>iptables -I FORWARD -d 10.10.9.9 -p all –dport all -j ACCEPT</p></blockquote>
<p>10.10.1.10 – this is the WAN IP address</p>
<p>10.10.9.9 – this is the LAN IP address</p>
<p>Add these lines for as many IP as you have / need. More on the topic <a href="http://www.dd-wrt.com/wiki/index.php/One-to-one_NAT" target="_blank">here</a>.</p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/04/DD-WRT-Scripts.png"><img class="aligncenter size-full wp-image-487" title="DD-WRT---Scripts" src="https://blog.stefcho.eu/wp-content/uploads/2011/04/DD-WRT-Scripts.png" alt="" width="789" height="641" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/04/DD-WRT-Scripts.png 789w,https://blog.stefcho.eu/wp-content/uploads/2011/04/DD-WRT-Scripts-300x243.png 300w" sizes="(max-width: 789px) 100vw, 789px"></a></p>
<p>In conclusion, this is a very quick and dirty way to publish internal machine to the internet, bear in mind that this host is fully exposed to anybody on the Internet. I personally don’t recommend this way of publishing, but if need arise you can consider this an option. In future posts I will try to present more smart and safe ways to publish some service.</p>
	</div>

	<footer class="entry-footer"><span class="cat-links">Posted in <a href="https://blog.stefcho.eu/category/technical/" rel="category tag">Technical</a></span><span class="tags-links">Tagged <a href="https://blog.stefcho.eu/tag/dd-wrt/" rel="tag">DD-WRT</a>, <a href="https://blog.stefcho.eu/tag/pfsense/" rel="tag">pfSense</a></span><span class="comments-link"><a href="https://blog.stefcho.eu/1-1-nat-in-pfsense-and-dd-wrt/#comments">5 Comments</a></span>	</footer></article><article id="post-450" class="entry post-450 post type-post status-publish format-standard hentry category-technical tag-dd-wrt tag-network tag-vmware"><header class="entry-header"><h2 class="entry-title"><a href="https://blog.stefcho.eu/running-dd-wrt-on-vmware-workstation-7-1/" rel="bookmark">Running DD-WRT on VMware Workstation 7.1</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <time class="entry-date published" datetime="2011-04-03T14:19:08+02:00">03/04/2011</time> - <time class="updated" datetime="2019-02-18T14:45:14+02:00">18/02/2019</time></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://blog.stefcho.eu/author/darko/">Stefan</a></span></span>		</div>
			</header><div class="entry-content">
		<p>Now that’s a tricky one.  The only official build that could be found is <a href="ftp://www.dd-wrt.com/v24/X86/public/vmware/DDx86_pure.zip" target="_blank">here</a></p>
<p>But it was published in the middle of 2008.  It is a pure v24, no Service Packs, this by itself makes it useless.</p>
<p>Guide for installing newer version is not available.</p>
<p>After searching the forums, the only usable thread that I found is this: <a href="http://www.dd-wrt.com/phpBB2/viewtopic.php?t=9998" target="_blank">VMware ready to use ..</a></p>
<p>Here stalonge share a pre-installed virtual machine ready to use.</p>
<p>My recommendation is to Restore it to Factory Default, and configure it to your preference.</p>
	</div>

	<footer class="entry-footer"><span class="cat-links">Posted in <a href="https://blog.stefcho.eu/category/technical/" rel="category tag">Technical</a></span><span class="tags-links">Tagged <a href="https://blog.stefcho.eu/tag/dd-wrt/" rel="tag">DD-WRT</a>, <a href="https://blog.stefcho.eu/tag/network/" rel="tag">Network</a>, <a href="https://blog.stefcho.eu/tag/vmware/" rel="tag">VMWare</a></span>	</footer></article><article id="post-431" class="entry post-431 post type-post status-publish format-standard hentry category-technical tag-network tag-pfsense tag-vmware"><header class="entry-header"><h2 class="entry-title"><a href="https://blog.stefcho.eu/install-pfsense-2-0-rc1-on-vmware-workstation-7/" rel="bookmark">Install pfSense 2.0 RC1 on VMWare Workstation 7</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <time class="entry-date published" datetime="2011-03-29T20:31:11+02:00">29/03/2011</time> - <time class="updated" datetime="2019-02-18T14:44:47+02:00">18/02/2019</time></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://blog.stefcho.eu/author/darko/">Stefan</a></span></span>		</div>
			</header><div class="entry-content">
		<p>On this video you can see the step by step guide of how to install pfSense 2.0 RC1 on VM Ware Workstation 7.1.</p>
<p>Download the ISO file from <a href="http://blog.pfsense.org/?p=585" target="_blank">Here</a>.</p>
<p>Configure the Virtual Machine and mount the ISO file.</p>
<p>Go over the Setup, and configure the interfaces.</p>
<p>As option you can enable SSH access.</p>
<p>This is the first part of the <a href="http://stefcho.azurewebsites.net/?p=438">network laboratory</a> setup.</p>
<p>Have fun, and I hope you enjoy the video.</p>
<p><object width="425" height="344"><param name="movie" value="http://www.youtube.com/v/JBFOcvhTlgA?hl=en&fs=1"><param name="allowFullScreen" value="true"><param name="allowscriptaccess" value="always"><embed type="application/x-shockwave-flash" width="425" height="344" src="http://www.youtube.com/v/JBFOcvhTlgA?hl=en&fs=1" allowscriptaccess="always" allowfullscreen="true"></embed></object></p>
	</div>

	<footer class="entry-footer"><span class="cat-links">Posted in <a href="https://blog.stefcho.eu/category/technical/" rel="category tag">Technical</a></span><span class="tags-links">Tagged <a href="https://blog.stefcho.eu/tag/network/" rel="tag">Network</a>, <a href="https://blog.stefcho.eu/tag/pfsense/" rel="tag">pfSense</a>, <a href="https://blog.stefcho.eu/tag/vmware/" rel="tag">VMWare</a></span><span class="comments-link"><a href="https://blog.stefcho.eu/install-pfsense-2-0-rc1-on-vmware-workstation-7/#comments">4 Comments</a></span>	</footer></article><article id="post-438" class="entry post-438 post type-post status-publish format-standard hentry category-technical tag-dd-wrt tag-network tag-openwrt tag-pfsense tag-vmware tag-vyatta"><header class="entry-header"><h2 class="entry-title"><a href="https://blog.stefcho.eu/my-network-laboratory/" rel="bookmark">My Network Laboratory</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <time class="entry-date published" datetime="2011-03-29T19:24:44+02:00">29/03/2011</time> - <time class="updated" datetime="2019-02-18T14:44:21+02:00">18/02/2019</time></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://blog.stefcho.eu/author/darko/">Stefan</a></span></span>		</div>
			</header><div class="entry-content">
		<p>  </p>
<p class="MsoNormal"><span lang="EN-GB">The easiest way to learn is by practice. This is especially true in IT. I have to lab out the migration from pfSense 1.2.3 to 2.0 RC1. Furthermore I have a site-to-site VPN setup that must be tested too. </span></p>
<p class="MsoNormal"><span lang="EN-GB">I decided to expand my laboratory setup to house not just the two versions of pfSense, but DD-WRT and OpenWrt also. This will give me a opportunity to expand my test with alternatives. That is not enough, so let’s add two of each as virtual machines. Now we need a router in the middle to move the traffic between different subnets. Using any of the above will be redundant, so after browsing the VMware market for router appliance, as first option came Untangle, but I have already played around with it, and it is not appropriate for my purposes. As reasonable alternative is Vyatta. I had no experience with this appliance, and decide to check it out. </span></p>
<p class="MsoNormal"><span lang="EN-GB">My finale network diagram looks like this:</span></p>
<p><a href="https://blog.stefcho.eu/wp-content/uploads/2011/03/Lab-Setup.png"></a><a href="https://blog.stefcho.eu/wp-content/uploads/2011/03/Lab-Setup1.png"><img class="aligncenter size-large wp-image-447" title="Lab Setup" src="https://blog.stefcho.eu/wp-content/uploads/2011/03/Lab-Setup1-1024x761.png" alt="" width="586" height="435" srcset="https://blog.stefcho.eu/wp-content/uploads/2011/03/Lab-Setup1-1024x761.png 1024w,https://blog.stefcho.eu/wp-content/uploads/2011/03/Lab-Setup1-300x223.png 300w,https://blog.stefcho.eu/wp-content/uploads/2011/03/Lab-Setup1.png 1051w" sizes="(max-width: 586px) 100vw, 586px"></a><br><span lang="EN-GB">The Console and Client are a simple Windows XP workstation from which to manage all the routers remotely by SSH and Web Interface.<span> </span></span></p>
<p class="MsoNormal"><span lang="EN-GB"><span> </span>As you can imagine if all the routers WAN addresses were in one sub-net, the Vyatta would be unnecessary, but my decision was based on the need to be able to test load balancing, fail over, and other scenarios in future. </span></p>
<p class="MsoNormal"><span lang="EN-GB">In the following post I will discuss in details the configuration of each type of route. As a brief impression from the installation and configuration starting from the easiest to setup and going to the hardest ones.</span></p>
<p class="MsoNormal"><span lang="EN-GB">PfSense have a Live CD, and is a breeze to install and configure on x86 virtual machine. </span></p>
<p class="MsoNormal"><span lang="EN-GB">Then is the Vyatta, also available on Live CD that can be installed on virtual machine. For the configuration I have used the shell, only later to discover that there is a web interface that is somewhat helpful. </span></p>
<p class="MsoNormal"><span lang="EN-GB">DD-WRT is hard to get on x86 virtual machine. I have opt out to find ready-made virtual machine and only to restore it to default configuration, and then to configure it to my preferences.</span></p>
<p class="MsoNormal"><span lang="EN-GB">OpenWrt is even harder. On the forums the recommended way is to compile it for this architecture, and then install it. There is a wonderful tutorial <a href="http://www.youtube.com/watch?v=cL81DQk4WL8" target="_blank">here </a>how to set it up on virtual box, but it does not work on VMware workstation. My guess is if you reconfigure the hard disk portions it will work. But yet again, my decision was to use ready-made virtual machine with the latest version, and configure it to my likings.</span></p>
<p class="MsoNormal"> </p>
<p class="MsoNormal"><span lang="EN-GB"><br></span></p>
<div id="_mcePaste" class="mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">
<p>  </p>
<p class="MsoNormal"><span lang="EN-GB">The easiest way to learn is by practice. This is especially true in IT. So now I have to lab out the migration from pfSense 1.2.3 to 2.0 RC1. Furthermore I have a site-to-site VPN setup that must be tested too. </span></p>
<p class="MsoNormal"><span lang="EN-GB"> </span></p>
<p class="MsoNormal"><span lang="EN-GB">I decided to expand my laboratory setup to house not just the two versions of pfSense, but DD-WRT and OpenWrt also. That is not enough, so let’s add two of each as virtual machines. Now we need a router in the middle to move the traffic between different subnets. Using any of the above will be redundant, so after browsing the VMware market for router appliance, as first option came Untangle, but I have already played around with it, and it is not appropriate for my purposes. As alternative to Untangle, Vyatta pop up from the result. I had no experience with this appliance, and decide to check it out. </span></p>
<p class="MsoNormal"><span lang="EN-GB">My finale network diagram is like this:</span></p>
<p class="MsoNormal"><span lang="EN-GB"> </span></p>
<p class="MsoNormal"><span lang="EN-GB">The console and Client are a simple Windows XP workstation from which to manage all the routers remotely by SSH and Web Interface.<span> </span></span></p>
<p class="MsoNormal"><span lang="EN-GB"><span> </span>As you can imagine if all the routers WAN addresses were in one subnet, the Vyatta would be unnecessary, but my decision was based on the need to be able to test load balancing, failover, and other scenarios in future. </span></p>
<p class="MsoNormal"><span lang="EN-GB"> </span></p>
<p class="MsoNormal"><span lang="EN-GB">In the following post I will discuss in details the configuration of each type of route. Now let’s go from the fore a brief impression from the installation and configuration starting from the easiest to setup and going to the hardest ones.</span></p>
<p class="MsoNormal"><span lang="EN-GB">PfSense have a live cd, and is a breeze to install and configure on x86 virtual machine. The only interesting this here is how to publish the web interface and the SSH on the WAN.</span></p>
<p class="MsoNormal"><span lang="EN-GB">Then is the Vyatta, also available on live cd that can be installed on virtual machine. For the configuration I have used the shell, only later to discover that there is a web interface that is somewhat helpful. </span></p>
<p class="MsoNormal"><span lang="EN-GB">DD-WRT is hard to get on x86 virtual machine. I have opt out to find ready-made virtual machine and only to restore it to default configuration, and then to configure it to my preferences.</span></p>
<p>  </p>
<p class="MsoNormal"><span lang="EN-GB">The easiest way to learn is by practice. This is especially true in IT. I have to lab out the migration from pfSense 1.2.3 to 2.0 RC1. Furthermore I have a site-to-site VPN setup that must be tested too. </span></p>
<p class="MsoNormal"><span lang="EN-GB">I decided to expand my laboratory setup to house not just the two versions of pfSense, but DD-WRT and OpenWrt also. This will give me a opportunity to expand my test with alternatives. That is not enough, so let’s add two of each as virtual machines. Now we need a router in the middle to move the traffic between different subnets. Using any of the above will be redundant, so after browsing the VMware market for router appliance, as first option came Untangle, but I have already played around with it, and it is not appropriate for my purposes. As reasonable alternative is Vyatta. I had no experience with this appliance, and decide to check it out. </span></p>
<p class="MsoNormal"><span lang="EN-GB">My finale network diagram looks like this:</span></p>
<p class="MsoNormal"><span lang="EN-GB"> </span></p>
<p class="MsoNormal"><span lang="EN-GB">The Console and Client are a simple Windows XP workstation from which to manage all the routers remotely by SSH and Web Interface.<span> </span></span></p>
<p class="MsoNormal"><span lang="EN-GB"><span> </span>As you can imagine if all the routers WAN addresses were in one subnet, the Vyatta would be unnecessary, but my decision was based on the need to be able to test load balancing, failover, and other scenarios in future. </span></p>
<p class="MsoNormal"><span lang="EN-GB">In the following post I will discuss in details the configuration of each type of route. As a brief impression from the installation and configuration starting from the easiest to setup and going to the hardest ones.</span></p>
<p class="MsoNormal"><span lang="EN-GB">PfSense have a live cd, and is a breeze to install and configure on x86 virtual machine. </span></p>
<p class="MsoNormal"><span lang="EN-GB">Then is the Vyatta, also available on live cd that can be installed on virtual machine. For the configuration I have used the shell, only later to discover that there is a web interface that is somewhat helpful. </span></p>
<p class="MsoNormal"><span lang="EN-GB">DD-WRT is hard to get on x86 virtual machine. I have opt out to find ready-made virtual machine and only to restore it to default configuration, and then to configure it to my preferences.</span></p>
<p class="MsoNormal"><span lang="EN-GB">OpenWrt is even harder. On the forums the recommended way is to compile it for this architecture, and then install it. There is a wonderful tutorial here how to set it up on virtual box, but it does not work on VMware workstation. My guess is if you reconfigure the hard disk portions it will work. But yet again, my decision was to use ready-made virtual machine with the latest version, and configure it to my likings.</span></p>
<p class="MsoNormal"><span lang="EN-GB">OpenWrt is even harder. On the forums the recommended way is to compile it for this architecture, and then install it. There is a wonderful tutorial here how to set it up on virtual box, but it does not work on VMware workstation. My guess is if you reconfigure the hard disk portions it will work. But yet again, my decision was to use ready-made virtual machine with the latest version, and configure it to my likings.</span></p>
<p class="MsoNormal"><span lang="EN-GB"> </span></p>
<p class="MsoNormal"><span lang="EN-GB"> </span></p>
</div>
	</div>

	<footer class="entry-footer"><span class="cat-links">Posted in <a href="https://blog.stefcho.eu/category/technical/" rel="category tag">Technical</a></span><span class="tags-links">Tagged <a href="https://blog.stefcho.eu/tag/dd-wrt/" rel="tag">DD-WRT</a>, <a href="https://blog.stefcho.eu/tag/network/" rel="tag">Network</a>, <a href="https://blog.stefcho.eu/tag/openwrt/" rel="tag">OpenWrt</a>, <a href="https://blog.stefcho.eu/tag/pfsense/" rel="tag">pfSense</a>, <a href="https://blog.stefcho.eu/tag/vmware/" rel="tag">VMWare</a>, <a href="https://blog.stefcho.eu/tag/vyatta/" rel="tag">Vyatta</a></span><span class="comments-link"><a href="https://blog.stefcho.eu/my-network-laboratory/#comments">2 Comments</a></span>	</footer></article><article id="post-378" class="entry post-378 post type-post status-publish format-standard hentry category-technical tag-asus tag-dd-wrt"><header class="entry-header"><h2 class="entry-title"><a href="https://blog.stefcho.eu/asus-rt-n16-supported-with-dd-wrt-100-pages-thread/" rel="bookmark">Asus RT-N16 supported with DD-WRT 100 pages thread</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <time class="entry-date published" datetime="2011-03-10T20:28:53+02:00">10/03/2011</time> - <time class="updated" datetime="2019-02-18T14:44:07+02:00">18/02/2019</time></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://blog.stefcho.eu/author/darko/">Stefan</a></span></span>		</div>
			</header><div class="entry-content">
		<p>One of the major sources of information about this model, and the supportability of different features was this topic.</p>
<p>Asus RT-N16 now supported</p>
<p><a href="http://www.dd-wrt.com/phpBB2/viewtopic.php?t=61570&postdays=0&postorder=asc&start=0">http://www.dd-wrt.com/phpBB2/viewtopic.php?t=61570&postdays=0&postorder=asc&start=0</a></p>
<p>Unfortunately as the last post states:</p>
<p>Murrkf: This thread is way too long to be practical. Outdated info is mixed with new info and few will read all 100 pages.</p>
<p>So you can,</p>
<p>SEE SUMMARY OF THIS THREAD AND CONTINUE DISCUSSION HERE:<br><a href="http://www.dd-wrt.com/phpBB2/viewtopic.php?t=88118" target="_blank">http://www.dd-wrt.com/phpBB2/viewtopic.php?t=88118</a></p>
	</div>

	<footer class="entry-footer"><span class="cat-links">Posted in <a href="https://blog.stefcho.eu/category/technical/" rel="category tag">Technical</a></span><span class="tags-links">Tagged <a href="https://blog.stefcho.eu/tag/asus/" rel="tag">ASUS</a>, <a href="https://blog.stefcho.eu/tag/dd-wrt/" rel="tag">DD-WRT</a></span><span class="comments-link"><a href="https://blog.stefcho.eu/asus-rt-n16-supported-with-dd-wrt-100-pages-thread/#comments">4 Comments</a></span>	</footer></article><nav class="navigation posts-navigation" role="navigation"><h2 class="screen-reader-text">Posts navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://blog.stefcho.eu/page/6/">Older posts</a></div><div class="nav-next"><a href="https://blog.stefcho.eu/page/4/">Newer posts</a></div></div>
	</nav></main></div>
			</div>
			<div class="columns small-12 medium-4">
				
<aside id="secondary" class="widget-area" role="complementary"><section id="tag_cloud-3" class="widget widget_tag_cloud"><h2 class="widget-title">Tags</h2><div class="tagcloud"><a href="https://blog.stefcho.eu/tag/adds/" class="tag-cloud-link tag-link-73 tag-link-position-1" style="font-size: 10.082644628099pt;" aria-label="ADDS (2 items)">ADDS</a>
<a href="https://blog.stefcho.eu/tag/aes-ni/" class="tag-cloud-link tag-link-114 tag-link-position-2" style="font-size: 10.082644628099pt;" aria-label="AES-NI (2 items)">AES-NI</a>
<a href="https://blog.stefcho.eu/tag/asterisk/" class="tag-cloud-link tag-link-55 tag-link-position-3" style="font-size: 10.082644628099pt;" aria-label="Asterisk (2 items)">Asterisk</a>
<a href="https://blog.stefcho.eu/tag/asus/" class="tag-cloud-link tag-link-60 tag-link-position-4" style="font-size: 11.471074380165pt;" aria-label="ASUS (3 items)">ASUS</a>
<a href="https://blog.stefcho.eu/tag/azure/" class="tag-cloud-link tag-link-94 tag-link-position-5" style="font-size: 12.628099173554pt;" aria-label="Azure (4 items)">Azure</a>
<a href="https://blog.stefcho.eu/tag/captive-portal/" class="tag-cloud-link tag-link-83 tag-link-position-6" style="font-size: 11.471074380165pt;" aria-label="Captive Portal (3 items)">Captive Portal</a>
<a href="https://blog.stefcho.eu/tag/cell-phone/" class="tag-cloud-link tag-link-64 tag-link-position-7" style="font-size: 8pt;" aria-label="Cell Phone (1 item)">Cell Phone</a>
<a href="https://blog.stefcho.eu/tag/centos/" class="tag-cloud-link tag-link-86 tag-link-position-8" style="font-size: 8pt;" aria-label="CentOS (1 item)">CentOS</a>
<a href="https://blog.stefcho.eu/tag/certification/" class="tag-cloud-link tag-link-105 tag-link-position-9" style="font-size: 10.082644628099pt;" aria-label="Certification (2 items)">Certification</a>
<a href="https://blog.stefcho.eu/tag/creative/" class="tag-cloud-link tag-link-66 tag-link-position-10" style="font-size: 10.082644628099pt;" aria-label="Creative (2 items)">Creative</a>
<a href="https://blog.stefcho.eu/tag/dd-wrt/" class="tag-cloud-link tag-link-57 tag-link-position-11" style="font-size: 14.363636363636pt;" aria-label="DD-WRT (6 items)">DD-WRT</a>
<a href="https://blog.stefcho.eu/tag/dns/" class="tag-cloud-link tag-link-92 tag-link-position-12" style="font-size: 8pt;" aria-label="DNS (1 item)">DNS</a>
<a href="https://blog.stefcho.eu/tag/hyper-v/" class="tag-cloud-link tag-link-67 tag-link-position-13" style="font-size: 12.628099173554pt;" aria-label="Hyper-V (4 items)">Hyper-V</a>
<a href="https://blog.stefcho.eu/tag/ldap/" class="tag-cloud-link tag-link-74 tag-link-position-14" style="font-size: 10.082644628099pt;" aria-label="LDAP (2 items)">LDAP</a>
<a href="https://blog.stefcho.eu/tag/learning/" class="tag-cloud-link tag-link-102 tag-link-position-15" style="font-size: 10.082644628099pt;" aria-label="Learning (2 items)">Learning</a>
<a href="https://blog.stefcho.eu/tag/linksys/" class="tag-cloud-link tag-link-56 tag-link-position-16" style="font-size: 8pt;" aria-label="Linksys (1 item)">Linksys</a>
<a href="https://blog.stefcho.eu/tag/microsoft/" class="tag-cloud-link tag-link-63 tag-link-position-17" style="font-size: 11.471074380165pt;" aria-label="Microsoft (3 items)">Microsoft</a>
<a href="https://blog.stefcho.eu/tag/mikrotik-routerboard-rb250g/" class="tag-cloud-link tag-link-79 tag-link-position-18" style="font-size: 8pt;" aria-label="Mikrotik RouterBoard RB250G (1 item)">Mikrotik RouterBoard RB250G</a>
<a href="https://blog.stefcho.eu/tag/network/" class="tag-cloud-link tag-link-65 tag-link-position-19" style="font-size: 19.107438016529pt;" aria-label="Network (17 items)">Network</a>
<a href="https://blog.stefcho.eu/tag/openldap/" class="tag-cloud-link tag-link-87 tag-link-position-20" style="font-size: 8pt;" aria-label="OpenLDAP (1 item)">OpenLDAP</a>
<a href="https://blog.stefcho.eu/tag/openvpn/" class="tag-cloud-link tag-link-72 tag-link-position-21" style="font-size: 16.561983471074pt;" aria-label="OpenVPN (10 items)">OpenVPN</a>
<a href="https://blog.stefcho.eu/tag/openwrt/" class="tag-cloud-link tag-link-71 tag-link-position-22" style="font-size: 8pt;" aria-label="OpenWrt (1 item)">OpenWrt</a>
<a href="https://blog.stefcho.eu/tag/pfcenter/" class="tag-cloud-link tag-link-85 tag-link-position-23" style="font-size: 8pt;" aria-label="pfCenter (1 item)">pfCenter</a>
<a href="https://blog.stefcho.eu/tag/pfsemse/" class="tag-cloud-link tag-link-95 tag-link-position-24" style="font-size: 8pt;" aria-label="pfSemse (1 item)">pfSemse</a>
<a href="https://blog.stefcho.eu/tag/pfsense/" class="tag-cloud-link tag-link-61 tag-link-position-25" style="font-size: 22pt;" aria-label="pfSense (31 items)">pfSense</a>
<a href="https://blog.stefcho.eu/tag/pfsense-2-0-rc1/" class="tag-cloud-link tag-link-81 tag-link-position-26" style="font-size: 13.553719008264pt;" aria-label="pfSense 2.0 RC1 (5 items)">pfSense 2.0 RC1</a>
<a href="https://blog.stefcho.eu/tag/pfsense-2-0-rc3/" class="tag-cloud-link tag-link-84 tag-link-position-27" style="font-size: 14.363636363636pt;" aria-label="pfSense 2.0 RC3 (6 items)">pfSense 2.0 RC3</a>
<a href="https://blog.stefcho.eu/tag/pfsense-2-2/" class="tag-cloud-link tag-link-90 tag-link-position-28" style="font-size: 11.471074380165pt;" aria-label="pfSense 2.2 (3 items)">pfSense 2.2</a>
<a href="https://blog.stefcho.eu/tag/pfsense-2-4-3/" class="tag-cloud-link tag-link-98 tag-link-position-29" style="font-size: 8pt;" aria-label="pfSense 2.4.3 (1 item)">pfSense 2.4.3</a>
<a href="https://blog.stefcho.eu/tag/pki/" class="tag-cloud-link tag-link-77 tag-link-position-30" style="font-size: 10.082644628099pt;" aria-label="PKI (2 items)">PKI</a>
<a href="https://blog.stefcho.eu/tag/radius/" class="tag-cloud-link tag-link-75 tag-link-position-31" style="font-size: 10.082644628099pt;" aria-label="RADIUS (2 items)">RADIUS</a>
<a href="https://blog.stefcho.eu/tag/routing/" class="tag-cloud-link tag-link-80 tag-link-position-32" style="font-size: 8pt;" aria-label="Routing (1 item)">Routing</a>
<a href="https://blog.stefcho.eu/tag/site-to-site/" class="tag-cloud-link tag-link-76 tag-link-position-33" style="font-size: 11.471074380165pt;" aria-label="Site To Site (3 items)">Site To Site</a>
<a href="https://blog.stefcho.eu/tag/technical/" class="tag-cloud-link tag-link-97 tag-link-position-34" style="font-size: 14.942148760331pt;" aria-label="Technical (7 items)">Technical</a>
<a href="https://blog.stefcho.eu/tag/uncategorized/" class="tag-cloud-link tag-link-96 tag-link-position-35" style="font-size: 8pt;" aria-label="Uncategorized (1 item)">Uncategorized</a>
<a href="https://blog.stefcho.eu/tag/vlan/" class="tag-cloud-link tag-link-78 tag-link-position-36" style="font-size: 8pt;" aria-label="VLAN (1 item)">VLAN</a>
<a href="https://blog.stefcho.eu/tag/vmware/" class="tag-cloud-link tag-link-62 tag-link-position-37" style="font-size: 14.942148760331pt;" aria-label="VMWare (7 items)">VMWare</a>
<a href="https://blog.stefcho.eu/tag/voip/" class="tag-cloud-link tag-link-59 tag-link-position-38" style="font-size: 10.082644628099pt;" aria-label="VoIP (2 items)">VoIP</a>
<a href="https://blog.stefcho.eu/tag/vyatta/" class="tag-cloud-link tag-link-70 tag-link-position-39" style="font-size: 8pt;" aria-label="Vyatta (1 item)">Vyatta</a>
<a href="https://blog.stefcho.eu/tag/web-sites/" class="tag-cloud-link tag-link-93 tag-link-position-40" style="font-size: 8pt;" aria-label="Web Sites (1 item)">Web Sites</a>
<a href="https://blog.stefcho.eu/tag/windows-server-8/" class="tag-cloud-link tag-link-88 tag-link-position-41" style="font-size: 8pt;" aria-label="Windows Server 8 (1 item)">Windows Server 8</a>
<a href="https://blog.stefcho.eu/tag/windows-server-2008-r2/" class="tag-cloud-link tag-link-68 tag-link-position-42" style="font-size: 12.628099173554pt;" aria-label="Windows Server 2008 R2 (4 items)">Windows Server 2008 R2</a>
<a href="https://blog.stefcho.eu/tag/windows-server-2012-r2/" class="tag-cloud-link tag-link-91 tag-link-position-43" style="font-size: 8pt;" aria-label="Windows Server 2012 R2 (1 item)">Windows Server 2012 R2</a>
<a href="https://blog.stefcho.eu/tag/wireless/" class="tag-cloud-link tag-link-82 tag-link-position-44" style="font-size: 8pt;" aria-label="Wireless (1 item)">Wireless</a>
<a href="https://blog.stefcho.eu/tag/workstation-8/" class="tag-cloud-link tag-link-89 tag-link-position-45" style="font-size: 8pt;" aria-label="Workstation 8 (1 item)">Workstation 8</a></div>
</section><section id="archives-3" class="widget widget_archive"><h2 class="widget-title">Archives</h2>		<ul><li><a href="https://blog.stefcho.eu/2019/05/">May 2019</a></li>
	<li><a href="https://blog.stefcho.eu/2019/03/">March 2019</a></li>
	<li><a href="https://blog.stefcho.eu/2019/02/">February 2019</a></li>
	<li><a href="https://blog.stefcho.eu/2018/10/">October 2018</a></li>
	<li><a href="https://blog.stefcho.eu/2018/08/">August 2018</a></li>
	<li><a href="https://blog.stefcho.eu/2016/03/">March 2016</a></li>
	<li><a href="https://blog.stefcho.eu/2015/04/">April 2015</a></li>
	<li><a href="https://blog.stefcho.eu/2015/03/">March 2015</a></li>
	<li><a href="https://blog.stefcho.eu/2015/01/">January 2015</a></li>
	<li><a href="https://blog.stefcho.eu/2012/02/">February 2012</a></li>
	<li><a href="https://blog.stefcho.eu/2011/10/">October 2011</a></li>
	<li><a href="https://blog.stefcho.eu/2011/09/">September 2011</a></li>
	<li><a href="https://blog.stefcho.eu/2011/08/">August 2011</a></li>
	<li><a href="https://blog.stefcho.eu/2011/07/">July 2011</a></li>
	<li><a href="https://blog.stefcho.eu/2011/06/">June 2011</a></li>
	<li><a href="https://blog.stefcho.eu/2011/05/">May 2011</a></li>
	<li><a href="https://blog.stefcho.eu/2011/04/">April 2011</a></li>
	<li><a href="https://blog.stefcho.eu/2011/03/">March 2011</a></li>
	<li><a href="https://blog.stefcho.eu/2011/02/">February 2011</a></li>
	<li><a href="https://blog.stefcho.eu/2010/07/">July 2010</a></li>
		</ul></section><section id="custom_html-3" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:inline-block;width:160px;height:600px" data-ad-client="ca-pub-3838187216577892" data-ad-slot="5149186217"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div></section></aside></div>
		</div>
	</section></div>

	<footer id="colophon" class="site-footer section-fullwidth"><div class="row">
			<div class="columns small-12">
				<div class="site-info">
					<a href="https://wordpress.org/">Proudly powered by WordPress</a>
					<span class="sep"> | </span>
					Theme: micro, developed by <a href="http://devrix.com">DevriX</a>.				</div>
			</div>
		</div>
	</footer></div>

<script type="text/javascript" src="https://blog.stefcho.eu/wp-content/themes/micro/assets/scripts/scripts.min.js"></script><script type="text/javascript">
/* <![CDATA[ */
var wpgdprcData = {"ajaxURL":"https:\/\/blog.stefcho.eu\/wp-admin\/admin-ajax.php","ajaxSecurity":"9e86627f7c","consentVersion":"1","consentStatus":"0","isMultisite":"","path":"\/","blogId":""};
/* ]]> */
</script><script type="text/javascript" src="https://blog.stefcho.eu/wp-content/plugins/wp-gdpr-compliance/assets/js/front.js"></script></body></html>
